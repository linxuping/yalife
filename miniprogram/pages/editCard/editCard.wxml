<!--miniprogram/pages/editCard/editCard.wxml-->
<view class="container">
  <image style="width:30px;height:30px;position:fixed;top:4px;left:4px;z-index:1000" src="../../images/back.png" mode="aspectFit" bindtap="goBack"></image>

  <view style="width:95%;margin-top:35px;margin-bottom:80px;text-align:center">
    <textarea placeholder="{{isSub==1?'举例：求租房/车位/二手单车/某家电等，我的微信***':'一堆杂乱闲置的堆在家里？分享给其他邻居当作宝吧！二手、招聘、赠送、求助、租借转让、爱心行动都可。末尾附带微信号～'}}" style="width:auto;text-align:left;min-height:200rpx;max-height:400rpx;background:#EFEFEF;border-radius:4px;padding:4px" value="{{content}}" bindinput="onInput" maxlength="1000" auto-height="{{auto_height}}" bindblur='areablur' bindfocus='areafocus'></textarea>
    <view style="width:100%;text-align:left;display:none">
      <text style="font-size:8pt">【技巧提醒】您的发布信息也可以不附带联系方式！因为已发布的条目可以在评论区“隐私回复“给您留言的人，避免外露您的联系方式给所有人看！</text>
    </view>  
  <view wx:if="{{isAdmin}}" style="margin-top:8px;border:solid red 1px">
    <text style="width:100%;background-color:#CDCDCD;display:none"> 审核 </text>
    <picker bindchange="bindPickerChange" value="{{index}}" range="{{array}}" style="border:dotted 1px">
      <view style="bottom-margin:20px;" bindtap="">
        <text>类型：</text>
        <text class="modify" style="color: blue">{{array[index]}}</text>
      </view>
    </picker>
    <picker bindchange="bindPickerChange2" value="{{index2}}" range="{{array2}}" style="display:none">
      <view style="bottom-margin:20px;" bindtap="">
        <text>类型2：</text>
        <text class="modify" style="color: blue">{{array2[index2]}}</text>
      </view>
    </picker>  
    <input placeholder="输入标签：a,b,c" style="border: dotted 1px" bindinput="getInput" type="text" value="{{ card.tags }}"></input>
    <view style="width:100%" wx:if="{{!!cardId}}">
      <input placeholder="推送标签" style="border: dotted 1px;display:inline-block" bindinput="onSaveNotifyInput" type="text" value="{{ card.notify_tag }}"></input>
      <button style="font-size:10px;display:inline-block" bindtap="saveNotify">记订阅</button>
      <button style="font-size:10px;display:inline-block" bindtap="pullNotify">拉订阅</button>
    </view>
    <button bindtap="auditOk">通过</button> 
    <input placeholder="下线原因" style="border: dotted 1px" bindinput="getReason" type="text"></input>
    <button bindtap="auditFail">不通过</button>
    <text >{{tagsCalc}}</text>
  </view>
  <view wx:if="{{isAdmin && showNotify}}" style="margin-top:8px;border:solid blue 1px">
    <text style="width:100%;background-color:#CDCDCD;display:none"> 通知 </text>
    
    <checkbox-group class="group" bindchange="checkboxChange">
      <block wx:for="{{notifyCards}}" wx:item="item">
        <view class="item">
          <checkbox value="{{item.name}}" checked="{{item.checked}}" color="red" />{{item.value}}
        </view>
      </block>
    </checkbox-group>
    <text class="selected">{{seletedStr}}</text>

    <button bindtap="notifyAll">通知</button>
  </view>

    <view style="bottom-margin:20px;margin-top:8px">
      <text>选择位置：</text>
      <form class="address modify" bindsubmit="choosePos" report-submit="{{true}}">
        <button formType="submit" style="display:inline;color:blue;font-size:30rpx;padding:0px" class="no-border-btn">{{address || '(请点击选择)'}}</button>
      </form>
    </view>

    <form bindsubmit="chooseImage" data-type="{{item}}" report-submit="{{true}}" class="keyword">
      <button formType="submit" class="noborder" style="margin:30rpx;border-radius: 30px;background-color: beige" wx:if="{{imgurls.length==0 && !imgurl}}">{{loading?'正在上传图片... ...':'增加图片'}}</button> 
      <button formType="submit" class="noborder" style="margin:30rpx;border-radius: 30px;background-color: beige" wx:else>{{loading?'正在上传图片... ...':'更换图片'}}</button> 
    </form>

    <view style="width:100%;text-align:left">
      <text wx:if="{{isSub==1}}" style="color:red">注意！该次订阅为一次性效果！当收到点开订阅消息后，如果还想继续订阅，请在详情页下方点击“我要继续订阅消息！”，下次遇到匹配的就能继续推送给您了😊</text>
    </view>

    <!-->
    <button class="noborder" style="margin:30rpx;border-radius: 30px;background-color: beige" bindtap="chooseImage" wx:if="{{imgurls.length==0 && !imgurl}}">{{loading?'正在上传图片... ...':'增加图片'}}</button> 
    <button class="noborder" style="margin:30rpx;border-radius: 30px;background-color: beige" bindtap="chooseImage" wx:else>{{loading?'正在上传图片... ...':'更换图片'}}</button> 
    -->
    <view>
    <image src="{{imgurl}}" wx:if="{{imgurl!=''}}" mode="aspectFit" style="display:none"></image>
    <image src="{{item}}" wx:if="{{!!item}}" style="width:100%" mode="aspectFit" wx:for="{{imgurls}}"></image>
    </view>     

    <!--<button class="noborder" style="margin:30rpx;border-radius: 30px;background-color: beige;display:none" bindtap="choosePos">修正位置,方便附近人找我</button>-->
    <form bindsubmit="choosePos" data-type="{{item}}" report-submit="{{true}}">
      <button formType="submit" class="keyword" style="margin:30rpx;border-radius: 30px;background-color: beige;display:none">修正位置,方便附近人找我</button>
    </form>

    <text style="text-decoration:underline" wx:if="{{!!cardId}}" bindtap="onDeleteCard">删除此次发布</text>
  </view>
  <form bindtap="updateCard" bindsubmit="saveFormid" data-type="update" report-submit="{{true}}" class="add-btn" wx:if="{{cardId}}">
    <button formType="submit">{{isSub==1?'修改（有符合的主动通知我）':'修改'}}</button>
  </form>
  <form bindtap="updateCard" bindsubmit="saveFormid" data-type="add" report-submit="{{true}}" class="add-btn" wx:else>
    <button formType="submit">{{isSub==1?'订阅（有符合的主动通知我）':'发布'}}</button>
  </form>

  <button class="add-btn" data-subscribe="1" data-type="add" style="bottom:50px;display:none"  bindtap="onSubscribe">有符合的主动通知我</button>
</view>
